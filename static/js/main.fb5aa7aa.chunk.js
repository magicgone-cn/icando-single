(this["webpackJsonpicando-single"]=this["webpackJsonpicando-single"]||[]).push([[0],{166:function(e,t,n){e.exports=n(326)},171:function(e,t,n){},172:function(e,t,n){},308:function(e,t,n){},326:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(4),i=n.n(o),c=(n(171),n(172),n(47)),l=n(22),s=n(26),d=n(43),u=n(41),h=n(44),p=n(333),m=n(335),f=n(331),y=n(46),v=n(334),b=n(327),E=n(328),g=n(330),x=n(329),k=n(127),j="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),O=function e(){Object(l.a)(this,e)};O.uuid=function(e,t){var n,a,r=j,o=[];if(t=t||r.length,e)for(n=0;n<e;n++)o[n]=r[0|Math.random()*t];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",n=0;n<36;n++)o[n]||(a=0|16*Math.random(),o[n]=r[19===n?3&a|8:a]);return o.join("")},O.uuidFast=function(){for(var e,t=j,n=new Array(36),a=0,r=0;r<36;r++)8===r||13===r||18===r||23===r?n[r]="-":14===r?n[r]="4":(a<=2&&(a=33554432+16777216*Math.random()|0),e=15&a,a>>=4,n[r]=t[19===r?3&e|8:e]);return n.join("")},O.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))};var C=function(){function e(){Object(l.a)(this,e)}return Object(s.a)(e,null,[{key:"isEmpty",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!(!t&&null===e)&&(!(!n&&void 0===e)&&(null===e||void 0===e||0===Object.keys(e).length))}}]),e}(),w=function(){function e(){Object(l.a)(this,e)}return Object(s.a)(e,null,[{key:"getLast",value:function(e){return e[e.length-1]}}]),e}(),S={root:Symbol.for("rootNode"),normal:Symbol.for("normalNode"),leaf:Symbol.for("leafNode")},N=function e(t){Object(l.a)(this,e),this.id="",this.title="",this.description="",this.completed=!1,this.expanded=!1,this.children=null,this.parent=null,this.type=S.normal,this.id=O.uuid(),this.title=t},I=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(d.a)(this,Object(u.a)(t).call(this,"root node"))).type=S.root,e.children=[],e}return Object(h.a)(t,e),t}(N);function M(e){return e.children.forEach((function(t){t.parent=e})),e}var T=function(){function e(){Object(l.a)(this,e)}return Object(s.a)(e,null,[{key:"clone",value:function(e){switch(e.type){case S.root:return Object.assign(new I,e);default:return Object.assign(new N,e)}}},{key:"append",value:function(t,n){var a=e.clone(t);return a.children?a.children=[].concat(Object(c.a)(a.children),[n]):a.children=[n],M(a),a}},{key:"update",value:function(t,n){var a=e.clone(t);return a.children=t.children.map((function(e){return e.id===n.id?n:e})),C.isEmpty(n.children)||n.children.forEach((function(e){e.parent=n})),M(a),a}},{key:"delete",value:function(t,n){var a=e.clone(t);return a.children=t.children.filter((function(e){return e.id!==n.id})),M(a),a}},{key:"insert",value:function(t,n,a){var r=e.clone(t);return r.children?r.children=[].concat(Object(c.a)(r.children.slice(0,a)),[n],Object(c.a)(r.children.slice(a))):r.children=[n],M(r),r}},{key:"refreshNode",value:function(t,n){if(n.id===t.id)return n;for(var a=n;;){var r=a.parent;if(r===t)break;if(r.type===S.root)throw new Error("\u65e0\u6548\u7684\u7236\u8282\u70b9");a=r}if(n.parent===t)return e.update(n.parent,n);var o=e.update(n.parent,n);return e.refreshNode(t,o)}},{key:"convertToJson",value:function(e){var t=function e(t){t.parent;var n=t.children,a=t.type,r=Object(k.a)(t,["parent","children","type"]);r.type=Symbol.keyFor(a),r.children=n?n.map((function(t){return e(t)})):null;return r}(e);return JSON.stringify(t)}},{key:"createFromJson",value:function(e){return function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t.type,o=t.children,i=Object(k.a)(t,["type","children"]);switch(Symbol.for(r)){case S.root:n=new I;break;default:n=new N}Object.assign(n,i),n.type=Symbol.for(r),n.children=o?o.map((function(t){return e(t,n)})):null;return n.parent=a,n}(JSON.parse(e))}},{key:"parseExtraInfo",value:function(t){var n={completedKeys:new Set,expandedKeys:new Set};return t.completed&&n.completedKeys.add(t.id),t.expanded&&n.expandedKeys.add(t.id),C.isEmpty(t.children)||t.children.forEach((function(t){var a=e.parseExtraInfo(t),r=a.completedKeys,o=a.expandedKeys;Object(c.a)(r).forEach((function(e){n.completedKeys.add(e)})),Object(c.a)(o).forEach((function(e){n.expandedKeys.add(e)}))})),n}}]),e}();var K=n(150),D=n(332),F=n(336),A={insert:Symbol.for("insert"),update:Symbol.for("update"),delete:Symbol.for("delete")},J=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),n.props.form.validateFields((function(e,t){if(!e){var a=Object(K.a)({},n.mission,{},t);n.props.onChange(a)}}))},n.mission=n.props.mission||new N(""),n.editType=n.props.mission?A.update:A.insert,n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.mission;return r.a.createElement(D.a,{onSubmit:this.handleSubmit},r.a.createElement(D.a.Item,{label:"\u4efb\u52a1ID",hidden:!0},e("id",{initialValue:t.id})(r.a.createElement(F.a,{readOnly:!0}))),r.a.createElement(D.a.Item,{label:"\u4efb\u52a1\u540d\u79f0"},e("title",{initialValue:t.title,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4efb\u52a1\u540d\u79f0"}]})(r.a.createElement(F.a,null))),r.a.createElement(D.a.Item,{label:"\u4efb\u52a1\u8be6\u60c5"},e("description",{initialValue:t.description})(r.a.createElement(F.a,null))),r.a.createElement(D.a.Item,null,r.a.createElement(y.a,{type:"primary",htmlType:"submit",block:!0},function(e){switch(e){case A.update:return"\u4fee\u6539";case A.insert:return"\u65b0\u589e";default:return"\u4fdd\u5b58"}}(this.editType)),r.a.createElement(y.a,{type:"default",block:!0,onClick:this.props.onCancel},"\u53d6\u6d88")))}}]),t}(r.a.Component);var L=D.a.create()(J);L.propTypes=J.propTypes;var B=L,P=(n(308),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={showCompleted:!1},n.openEditor=function(e){var t=new Promise((function(t){var n=p.a.info({icon:null,okButtonProps:{style:{display:"none"}},content:r.a.createElement(B,{mission:e,onChange:function(e){t(e),n.destroy()},onCancel:function(){n.destroy()}})})}));return{onChange:function(e){t.then((function(t){e(t)}))}}},n.refreshNode=function(e){var t=n.props.rootMission;e.type===S.root?n.props.onChange(e):n.props.onChange(T.refreshNode(t,e))},n.handleCompletedChange=function(e,t){var a=t.checked,r=t.node.props["data-mission"];n.refreshNode(Object.assign(T.clone(r),{completed:a}))},n.renderTreeNodes=function(e){var t=n.state.showCompleted;if(e)return e.map((function(e){return r.a.createElement(m.a.TreeNode,{className:"treeNode",style:!t&&e.completed?{display:"none"}:{},key:e.id,"data-mission":e,title:r.a.createElement("ol",null,r.a.createElement(f.a.Item,{className:"mission",actions:[r.a.createElement(y.a,{className:"btn-hidden",onClick:function(){n.handleEdit(e)}},"\u7f16\u8f91"),r.a.createElement(y.a,{className:"btn-hidden",onClick:function(){n.handleDelete(e)}},"\u5220\u9664"),r.a.createElement(y.a,{className:"btn-hidden",onClick:function(){n.handleAdd(e)}},"\u6dfb\u52a0")]},r.a.createElement(f.a.Item.Meta,{title:e.title,description:e.description})))},!C.isEmpty(e.children)&&n.renderTreeNodes(e.children))}))},n.renderMission=function(e){var t=n.state.showCompleted;return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a.Item,{hidden:!t&&e.completed,className:"mission",actions:[r.a.createElement(y.a,{className:"btn-hidden",onClick:function(){n.handleEdit(e)}},"\u7f16\u8f91"),r.a.createElement(y.a,{className:"btn-hidden",onClick:function(){n.handleDelete(e)}},"\u5220\u9664"),r.a.createElement(y.a,{className:"btn-hidden",onClick:function(){n.handleAdd(e)}},"\u6dfb\u52a0")]},r.a.createElement(v.a,{checked:e.completed,onChange:n.handleCompletedChange,"data-mission":e,style:{marginRight:"20px"}}),r.a.createElement(f.a.Item.Meta,{title:e.title,description:e.description})),e.children&&Object.keys(e.children).length>0&&r.a.createElement(f.a,{style:{marginLeft:"20px"},dataSource:e.children,rowKey:function(e){return e.id},renderItem:function(e){return n.renderMission(e)}}))},n.handleEdit=function(e){n.openEditor(e).onChange((function(e){n.refreshNode(e)}))},n.handleDelete=function(e){n.refreshNode(T.delete(e.parent,e))},n.handleAdd=function(e){n.openEditor().onChange((function(t){n.refreshNode(T.append(e,t))}))},n.handleShowCompletedChange=function(e){n.setState({showCompleted:e})},n.handleDrop=function(e){var t=e.node,a=e.dragNode,r=t,o=e.dropPosition-parseInt(w.getLast(t.props.pos.split("-"))),i=r.props["data-mission"],c=a.props["data-mission"],l=n.props.rootMission,s=T.delete(c.parent,c);l=T.refreshNode(l,s);for(var d=s;;){if(d.id===i.id){i=d;break}if(d.type===S.root)break;d=d.parent}if(0===o)l=T.refreshNode(l,T.append(i,c));else{var u=i.parent.children.indexOf(i),h=-1===o?u:u+1;l=T.refreshNode(l,T.insert(i.parent,c,h))}n.refreshNode(l)},n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.rootMission.children,n=T.parseExtraInfo(this.props.rootMission),a=n.completedKeys;n.expandedKeys;return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{type:"flex",justify:"center"},r.a.createElement(E.a,{style:{textAlign:"center"}},r.a.createElement(g.a.Title,null,"I CAN DO"),r.a.createElement(x.a,{checkedChildren:"\u663e\u793a\u5df2\u5b8c\u6210",unCheckedChildren:"\u9690\u85cf\u5df2\u5b8c\u6210",checked:this.state.showCompleted,onChange:this.handleShowCompletedChange}))),r.a.createElement(b.a,{type:"flex",justify:"space-around",style:{minHeight:"50vh"}},r.a.createElement(E.a,{span:16},r.a.createElement(m.a,{blockNode:!0,checkStrictly:!0,checkable:!0,checkedKeys:Object(c.a)(a),onCheck:this.handleCompletedChange,draggable:!0,onDrop:this.handleDrop},this.renderTreeNodes(t))),r.a.createElement(E.a,{span:10},r.a.createElement(y.a,{type:"primary",block:!0,onClick:function(){e.handleAdd(e.props.rootMission)}},"add mission"))),r.a.createElement(b.a,{type:"flex",justify:"center"},r.a.createElement(E.a,{span:4},r.a.createElement(y.a,{type:"default",block:!0,onClick:this.props.onSave},"save")),r.a.createElement(E.a,{span:4},r.a.createElement(y.a,{type:"default",block:!0,onClick:this.props.onExport},"export")),r.a.createElement(E.a,{span:4},r.a.createElement(y.a,{type:"default",block:!0,onClick:this.props.onImport},"import"))))}}]),t}(r.a.Component)),R=n(83);Symbol.for("insert"),Symbol.for("update"),Symbol.for("delete");var V,U=(V=P,function(e){function t(e){var n;Object(l.a)(this,t),(n=Object(d.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){n.setState({rootMission:e},n.handleSave)},n.handleSave=function(){var e=T.convertToJson(n.state.rootMission);return localStorage.setItem("rootMission",e),Promise.resolve(e)},n.handleLoad=function(){var e=localStorage.getItem("rootMission");if(e){var t=T.createFromJson(e);n.setState({rootMission:t})}},n.handleExport=function(){n.handleSave().then((function(e){var t=new Blob([e],{type:"text/json"}),n=document.createElement("a");n.download="icando.json",n.href=window.URL.createObjectURL(t),n.dataset.downloadurl=["text/json",n.download,n.href].join(":"),n.click()}))},n.handleImportInit=function(){var e=document.createElement("input");e.type="file",e.accept=".json",e.addEventListener("change",(function(e){var t=e.path[0].files.item(0),a=new FileReader;a.onload=function(e){var t=e.target.result,a=T.createFromJson(t);n.setState({rootMission:a})},a.readAsText(t)})),n.importInput=e},n.handleImport=function(){n.importInput.click()};var a=new I;return n.state={rootMission:a,missionMap:Object(R.a)({},a.id,a)},n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.handleImportInit(),this.handleLoad()}},{key:"render",value:function(){var e=this.state.rootMission;return r.a.createElement(V,Object.assign({},this.props,{rootMission:e,onChange:this.handleChange,onSave:this.handleSave,onExport:this.handleExport,onImport:this.handleImport}))}}]),t}(r.a.Component));var W=function(){return r.a.createElement(U,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[166,1,2]]]);
//# sourceMappingURL=main.fb5aa7aa.chunk.js.map